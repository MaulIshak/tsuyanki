import{c as U,r as c,a as I,o as O,b as G,d as v,e as t,f as s,t as w,u as a,g as z,_ as q,C as D,w as o,h as d,i as Y,j as k,k as J,l as K,m as Q,n as B,p as W,q as X,s as Z,v as P,x as H,y as ee,z as n}from"./index-DhmeCW2F.js";import{_ as te}from"./CardFooter-DtCFFoNU.js";import{_ as ae}from"./Progress-BkZB-F1d.js";import{_ as N}from"./Separator-Dx5RNCQl.js";const se=U("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);const le=U("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),re=(S,L)=>{const g=S.__vccOpts||S;for(const[h,f]of L)g[h]=f;return g},oe={class:"min-h-full flex flex-col max-w-4xl mx-auto w-full p-4 lg:p-8"},ne={class:"mb-8 space-y-2 shrink-0"},ie={class:"flex items-center justify-between text-sm text-slate-500 dark:text-slate-400"},de={class:"flex-1 flex flex-col items-center w-full relative"},ue={key:0,class:"w-full max-w-2xl space-y-4 my-auto"},ce={class:"flex justify-center gap-4"},ve={key:1,class:"text-center space-y-6 my-auto"},fe={class:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 mb-4"},me={class:"text-slate-500 dark:text-slate-400 max-w-md mx-auto text-lg"},xe={class:"flex flex-col sm:flex-row justify-center gap-4 pt-4 px-4 sm:px-0 w-full"},pe={class:"flex items-center gap-2 bg-slate-50 dark:bg-slate-900 p-1 rounded-lg border border-slate-200 dark:border-slate-800 w-full sm:w-auto order-1 sm:order-2"},be={class:"relative w-20 shrink-0"},ge={class:"flex justify-between items-center"},we={class:"prose dark:prose-invert max-w-none text-center w-full break-words"},ke=["innerHTML"],_e={key:0,class:"w-full flex items-center gap-4 animate-in fade-in duration-300"},he={key:1,class:"w-full animate-in slide-in-from-bottom-2 duration-300"},ye={key:0,class:"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-800 dark:text-emerald-300 p-3 rounded-lg border border-emerald-200 dark:border-emerald-800 text-center font-medium"},Ce={key:1,class:"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300 p-3 rounded-lg border border-red-200 dark:border-red-800 text-center flex flex-col gap-1"},$e={class:"line-through opacity-75 decoration-2"},Se={class:"font-bold flex items-center justify-center gap-2"},Le={key:2,class:"prose dark:prose-invert max-w-none w-full break-words animate-in slide-in-from-bottom-2 duration-300 text-left"},je=["innerHTML"],Ae={key:1,class:"grid grid-cols-4 gap-3 w-full animate-in fade-in slide-in-from-bottom-2 duration-300"},Te={class:"flex flex-col gap-1 group"},Re={class:"flex flex-col gap-1 group"},qe={class:"flex flex-col gap-1 group"},Be={class:"flex flex-col gap-1 group"},Ee={__name:"StudyView",setup(S){const L=Y(),g=Z(),h="https://activities-associates-involving-soul.trycloudflare.com/api/v1",f=c([]),y=c(0),u=c(!1),C=c(!0),m=c(!1),j=c(20),r=c({total:0,reviewed:0,correct:0}),x=c(null),_=c(null),p=I(()=>!f.value||f.value.length===0?null:f.value[y.value]),F=I(()=>r.value.total===0?0:r.value.reviewed/r.value.total*100),E=async(l=!1,e=null)=>{C.value=!0;const i=localStorage.getItem("auth_token"),$=e||g.query.limit||20,A=new URLSearchParams({limit:$.toString()});(l===!0||g.query.deck_id)&&A.append("ignore_limits","1"),g.query.deck_id&&A.append("deck_id",g.query.deck_id);try{const{data:T}=await P(`${h}/review/due?${A.toString()}`,{headers:{Authorization:`Bearer ${i}`}}).json();if(T.value){const R=T.value.cards||[];f.value=R,l?r.value.total+=R.length:(r.value.total=R.length,r.value.reviewed=0,r.value.correct=0),y.value=0,u.value=!1,x.value=null,_.value=null}}catch{H.error("Failed to load cards",{description:"Please try again later."})}finally{C.value=!1}},M=()=>{const l=document.querySelector('input[placeholder="Type answer..."]');l?x.value=l.value:x.value=null,u.value=!0,ee(()=>{const e=document.getElementById("typeans-correct");e?_.value=e.innerText:_.value=null})},b=async l=>{if(!p.value||m.value)return;m.value=!0;const e=localStorage.getItem("auth_token"),i=p.value.id||p.value.card_id;try{const{error:$}=await P(`${h}/review/${i}`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({quality:l})}).json();if($.value)throw new Error("Review failed");r.value.reviewed++,l>=3&&r.value.correct++,y.value<f.value.length-1?(y.value++,u.value=!1,x.value=null,_.value=null):f.value=[]}catch{H.error("Failed to save review",{description:"Your progress was not saved."})}finally{m.value=!1}},V=l=>{if(!(C.value||!p.value)&&(l.code==="Space"&&(l.preventDefault(),u.value||M()),u.value&&!m.value))switch(l.key){case"1":b(1);break;case"2":b(2);break;case"3":b(3);break;case"4":b(4);break}};return O(()=>{E(),window.addEventListener("keydown",V)}),G(()=>{window.removeEventListener("keydown",V)}),(l,e)=>(n(),v("div",oe,[t("div",ne,[t("div",ie,[e[7]||(e[7]=t("span",{class:"font-medium"},"Daily Review",-1)),t("span",null,w(r.value.reviewed)+" / "+w(r.value.total),1)]),s(a(ae),{"model-value":F.value,class:"h-2"},null,8,["model-value"])]),t("div",de,[C.value?(n(),v("div",ue,[s(a(q),{class:"h-[300px] w-full rounded-xl"}),t("div",ce,[s(a(q),{class:"h-12 w-24"}),s(a(q),{class:"h-12 w-24"})])])):p.value?(n(),z(a(X),{key:2,class:"w-full max-w-2xl shadow-xl border-t-4 border-t-indigo-500 dark:bg-slate-900 my-auto mb-8"},{default:o(()=>[s(a(Q),null,{default:o(()=>[t("div",ge,[s(a(K),{variant:"outline",class:"uppercase tracking-wide text-[10px]"},{default:o(()=>[d(w(p.value.template?.name||"Standard"),1)]),_:1}),e[11]||(e[11]=t("span",{class:"text-xs text-slate-400"},"Press Space to reveal",-1))])]),_:1}),s(a(W),{class:"py-6 px-6 min-h-[200px] flex flex-col gap-6 max-h-[60vh] overflow-y-auto w-full"},{default:o(()=>[t("div",we,[t("div",{class:"text-xl font-medium",innerHTML:p.value.front_html},null,8,ke)]),u.value?(n(),v("div",_e,[s(a(N),{class:"flex-1"}),e[12]||(e[12]=t("span",{class:"text-xs text-slate-400 uppercase"},"Answer",-1)),s(a(N),{class:"flex-1"})])):B("",!0),u.value&&x.value!==null?(n(),v("div",he,[x.value.trim().toLowerCase()===_.value?.trim().toLowerCase()?(n(),v("div",ye,[s(a(D),{class:"w-5 h-5 inline-block mr-2 align-text-bottom"}),d(" Correct! ("+w(x.value)+") ",1)])):(n(),v("div",Ce,[t("div",$e,w(x.value||"(Empty)"),1),t("div",Se,[s(a(se),{class:"w-4 h-4"}),d(" "+w(_.value),1)])]))])):B("",!0),u.value?(n(),v("div",Le,[t("div",{class:"text-lg",innerHTML:p.value.back_html},null,8,je)])):B("",!0)]),_:1}),s(a(te),{class:"flex flex-col gap-4 border-t bg-slate-50/50 dark:bg-slate-950/30 p-6"},{default:o(()=>[u.value?(n(),v("div",Ae,[t("div",Te,[s(a(k),{onClick:e[3]||(e[3]=i=>b(1)),variant:"outline",class:"h-14 hover:bg-rose-100 hover:text-rose-700 hover:border-rose-200 dark:hover:bg-rose-900/30 dark:hover:text-rose-400 border-b-4 active:border-b-0 active:translate-y-1",disabled:m.value},{default:o(()=>[...e[14]||(e[14]=[d(" Again ",-1)])]),_:1},8,["disabled"]),e[15]||(e[15]=t("span",{class:"text-[10px] text-center text-slate-400 group-hover:text-slate-600 uppercase font-bold tracking-wider"},"< 1m",-1))]),t("div",Re,[s(a(k),{onClick:e[4]||(e[4]=i=>b(2)),variant:"outline",class:"h-14 hover:bg-orange-100 hover:text-orange-700 hover:border-orange-200 dark:hover:bg-orange-900/30 dark:hover:text-orange-400 border-b-4 active:border-b-0 active:translate-y-1",disabled:m.value},{default:o(()=>[...e[16]||(e[16]=[d(" Hard ",-1)])]),_:1},8,["disabled"]),e[17]||(e[17]=t("span",{class:"text-[10px] text-center text-slate-400 group-hover:text-slate-600 uppercase font-bold tracking-wider"},"2d",-1))]),t("div",qe,[s(a(k),{onClick:e[5]||(e[5]=i=>b(3)),variant:"outline",class:"h-14 hover:bg-blue-100 hover:text-blue-700 hover:border-blue-200 dark:hover:bg-blue-900/30 dark:hover:text-blue-400 border-b-4 active:border-b-0 active:translate-y-1",disabled:m.value},{default:o(()=>[...e[18]||(e[18]=[d(" Good ",-1)])]),_:1},8,["disabled"]),e[19]||(e[19]=t("span",{class:"text-[10px] text-center text-slate-400 group-hover:text-slate-600 uppercase font-bold tracking-wider"},"4d",-1))]),t("div",Be,[s(a(k),{onClick:e[6]||(e[6]=i=>b(4)),variant:"outline",class:"h-14 hover:bg-emerald-100 hover:text-emerald-700 hover:border-emerald-200 dark:hover:bg-emerald-900/30 dark:hover:text-emerald-400 border-b-4 active:border-b-0 active:translate-y-1",disabled:m.value},{default:o(()=>[...e[20]||(e[20]=[d(" Easy ",-1)])]),_:1},8,["disabled"]),e[21]||(e[21]=t("span",{class:"text-[10px] text-center text-slate-400 group-hover:text-slate-600 uppercase font-bold tracking-wider"},"7d",-1))])])):(n(),z(a(k),{key:0,onClick:M,class:"w-full h-12 text-lg font-semibold tracking-wide",size:"lg"},{default:o(()=>[...e[13]||(e[13]=[d(" Show Answer ",-1)])]),_:1}))]),_:1})]),_:1})):(n(),v("div",ve,[t("div",fe,[s(a(D),{class:"w-10 h-10"})]),e[10]||(e[10]=t("h2",{class:"text-3xl font-bold tracking-tight text-slate-900 dark:text-slate-50"},"Session Complete!",-1)),t("p",me," You reviewed "+w(r.value.reviewed)+" cards today. Great job keeping up with your streak! ",1),t("div",xe,[s(a(k),{onClick:e[0]||(e[0]=i=>a(L).push("/dashboard")),size:"lg",variant:"outline",class:"w-full sm:w-auto order-2 sm:order-1"},{default:o(()=>[...e[8]||(e[8]=[d(" Back to Dashboard ",-1)])]),_:1}),t("div",pe,[t("div",be,[s(a(J),{type:"number",min:"1",max:"100",modelValue:j.value,"onUpdate:modelValue":e[1]||(e[1]=i=>j.value=i),class:"h-10 border-0 bg-transparent text-center focus-visible:ring-0 focus-visible:ring-offset-0"},null,8,["modelValue"])]),s(a(k),{onClick:e[2]||(e[2]=()=>E(!0,j.value)),size:"lg",class:"flex-1 sm:flex-initial"},{default:o(()=>[s(a(le),{class:"w-4 h-4 mr-2"}),e[9]||(e[9]=d(" Review More ",-1))]),_:1})])])]))])]))}},De=re(Ee,[["__scopeId","data-v-494e2e35"]]);export{De as default};
