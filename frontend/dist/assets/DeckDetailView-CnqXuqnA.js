import{c as K,d as V,Y as Xe,Z as Pe,a as j,$ as Ye,i as he,k as et,b as h,o as r,w as s,q as a,u as e,P as O,r as $,a0 as tt,a1 as at,M as st,a2 as lt,a3 as be,h as w,a4 as je,a5 as ot,a6 as Le,m as z,a7 as Ne,a8 as ke,a9 as ze,n as Y,g as ee,aa as we,ab as nt,ac as G,ad as rt,ae as fe,af as dt,ag as ut,s as P,ah as it,ai as ct,S as pt,e as te,p as u,f as ae,j as ft,O as mt,l as k,x as _,N as vt,B as F,E as I,H as B,aj as _t,G as Ce,W as yt,F as A,D as N,Q as ve,R as _e,T as ye,ak as Ie,al as Ve,I as ue,U as ie,X as ge,J as H,K as D}from"./index-ZLCpMZbQ.js";import{_ as gt}from"./Textarea-ZfpTOFk5.js";import{_ as ht,a as bt,b as ce,c as Z,d as kt,e as S}from"./TableHeader-DSyZU7_b.js";import{_ as wt,a as xt,b as $t,c as qt,d as Mt,e as Ct,f as It,g as Vt}from"./AlertDialogTitle-iSL8dLLQ.js";import{P as St,S as Tt,E as Se,g as Bt,_ as Dt,a as Rt,b as Ft,c as At,d as Pt,e as jt,f as Lt}from"./PaginationPrevious-cFX-XOjN.js";import{c as Nt,_ as zt,a as Et,b as Te}from"./SelectTrigger-C9nAWsa_.js";import{d as X}from"./mediaUtils-BkYuhlKK.js";import{A as Ht}from"./arrow-left-BrTGBG7X.js";import"./DialogTitle-6lcKACdm.js";const Kt=K("arrow-down-wide-narrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);const Ot=K("arrow-up-narrow-wide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);const Gt=K("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const Ut=K("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const Wt=K("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);const Be=K("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);const De=K("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var Jt=V({__name:"RovingFocusItem",props:{tabStopId:{type:String,required:!1},focusable:{type:Boolean,required:!1,default:!0},active:{type:Boolean,required:!1},allowShiftKey:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(i){const o=i,n=Xe(),d=Pe(),p=j(()=>o.tabStopId||d),f=j(()=>n.currentTabStopId.value===p.value),{getItems:c,CollectionItem:m}=Ye();he(()=>{o.focusable&&n.onFocusableItemAdd()}),et(()=>{o.focusable&&n.onFocusableItemRemove()});function g(v){if(v.key==="Tab"&&v.shiftKey){n.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const b=tt(v,n.orientation.value,n.dir.value);if(b!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||!o.allowShiftKey&&v.shiftKey)return;v.preventDefault();let q=[...c().map(T=>T.ref).filter(T=>T.dataset.disabled!=="")];if(b==="last")q.reverse();else if(b==="prev"||b==="next"){b==="prev"&&q.reverse();const T=q.indexOf(v.currentTarget);q=n.loop.value?at(q,T+1):q.slice(T+1)}st(()=>lt(q))}}return(v,b)=>(r(),h(e(m),null,{default:s(()=>[a(e(O),{tabindex:f.value?0:-1,"data-orientation":e(n).orientation.value,"data-active":v.active?"":void 0,"data-disabled":v.focusable?void 0:"",as:v.as,"as-child":v.asChild,onMousedown:b[0]||(b[0]=q=>{v.focusable?e(n).onItemFocus(p.value):q.preventDefault()}),onFocus:b[1]||(b[1]=q=>e(n).onItemFocus(p.value)),onKeydown:g},{default:s(()=>[$(v.$slots,"default")]),_:3},8,["tabindex","data-orientation","data-active","data-disabled","as","as-child"])]),_:3}))}}),Qt=Jt;const[Zt,Xt]=be(["MenuCheckboxItem","MenuRadioItem"],"MenuItemIndicatorContext");var Yt=V({__name:"MenuItemIndicator",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(i){const o=Zt({modelValue:w(!1)});return(n,d)=>(r(),h(e(Le),{present:n.forceMount||e(ot)(e(o).modelValue.value)||e(o).modelValue.value===!0},{default:s(()=>[a(e(O),{as:n.as,"as-child":n.asChild,"data-state":e(je)(e(o).modelValue.value)},{default:s(()=>[$(n.$slots,"default")]),_:3},8,["as","as-child","data-state"])]),_:3},8,["present"]))}}),ea=Yt,ta=V({__name:"MenuGroup",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(i){const o=i;return(n,d)=>(r(),h(e(O),z({role:"group"},o),{default:s(()=>[$(n.$slots,"default")]),_:3},16))}}),aa=ta;const[sa,la]=be("MenuRadioGroup");var oa=V({__name:"MenuRadioGroup",props:{modelValue:{type:String,required:!1,default:""},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["update:modelValue"],setup(i,{emit:o}){const n=i,d=o,p=Ne(n,["modelValue"]),f=ke(p),c=ze(n,"modelValue",d);return la({modelValue:c,onValueChange:m=>{c.value=m}}),(m,g)=>(r(),h(aa,Y(ee(e(f))),{default:s(()=>[$(m.$slots,"default",{modelValue:e(c)})]),_:3},16))}}),na=oa,ra=V({__name:"MenuRadioItem",props:{value:{type:String,required:!0},disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(i,{emit:o}){const n=i,d=o,p=Ne(n,["value"]),f=ke(p),{value:c}=we(n),m=sa(),g=j(()=>m.modelValue.value===c?.value);return Xt({modelValue:g}),(v,b)=>(r(),h(nt,z({role:"menuitemradio"},e(f),{"aria-checked":g.value,"data-state":e(je)(g.value),onSelect:b[0]||(b[0]=async q=>{d("select",q),e(m).onValueChange(e(c))})}),{default:s(()=>[$(v.$slots,"default")]),_:3},16,["aria-checked","data-state"]))}}),da=ra,ua=V({__name:"DropdownMenuItemIndicator",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(i){const o=i;return G(),(n,d)=>(r(),h(e(ea),Y(ee(o)),{default:s(()=>[$(n.$slots,"default")]),_:3},16))}}),ia=ua,ca=V({__name:"DropdownMenuRadioGroup",props:{modelValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["update:modelValue"],setup(i,{emit:o}){const n=i,p=rt(o);return G(),(f,c)=>(r(),h(e(na),Y(ee({...n,...e(p)})),{default:s(()=>[$(f.$slots,"default")]),_:3},16))}}),pa=ca,fa=V({__name:"DropdownMenuRadioItem",props:{value:{type:String,required:!0},disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(i,{emit:o}){const p=fe(i,o);return G(),(f,c)=>(r(),h(e(da),Y(ee(e(p))),{default:s(()=>[$(f.$slots,"default")]),_:3},16))}}),ma=fa;const[xe,va]=be("TabsRoot");var _a=V({__name:"TabsRoot",props:{defaultValue:{type:null,required:!1},orientation:{type:String,required:!1,default:"horizontal"},dir:{type:String,required:!1},activationMode:{type:String,required:!1,default:"automatic"},modelValue:{type:null,required:!1},unmountOnHide:{type:Boolean,required:!1,default:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["update:modelValue"],setup(i,{emit:o}){const n=i,d=o,{orientation:p,unmountOnHide:f,dir:c}=we(n),m=dt(c);G();const g=ze(n,"modelValue",d,{defaultValue:n.defaultValue,passive:n.modelValue===void 0}),v=w();return va({modelValue:g,changeModelValue:b=>{g.value=b},orientation:p,dir:m,unmountOnHide:f,activationMode:n.activationMode,baseId:Pe(void 0,"reka-tabs"),tabsList:v}),(b,q)=>(r(),h(e(O),{dir:e(m),"data-orientation":e(p),"as-child":b.asChild,as:b.as},{default:s(()=>[$(b.$slots,"default",{modelValue:e(g)})]),_:3},8,["dir","data-orientation","as-child","as"]))}}),ya=_a;function Ee(i,o){return`${i}-trigger-${o}`}function He(i,o){return`${i}-content-${o}`}var ga=V({__name:"TabsContent",props:{value:{type:[String,Number],required:!0},forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(i){const o=i,{forwardRef:n}=G(),d=xe(),p=j(()=>Ee(d.baseId,o.value)),f=j(()=>He(d.baseId,o.value)),c=j(()=>o.value===d.modelValue.value),m=w(c.value);return he(()=>{requestAnimationFrame(()=>{m.value=!1})}),(g,v)=>(r(),h(e(Le),{present:g.forceMount||c.value,"force-mount":""},{default:s(({present:b})=>[a(e(O),{id:f.value,ref:e(n),"as-child":g.asChild,as:g.as,role:"tabpanel","data-state":c.value?"active":"inactive","data-orientation":e(d).orientation.value,"aria-labelledby":p.value,hidden:!b,tabindex:"0",style:ut({animationDuration:m.value?"0s":void 0})},{default:s(()=>[!e(d).unmountOnHide.value||b?$(g.$slots,"default",{key:0}):P("v-if",!0)]),_:2},1032,["id","as-child","as","data-state","data-orientation","aria-labelledby","hidden","style"])]),_:3},8,["present"]))}}),ha=ga,ba=V({__name:"TabsList",props:{loop:{type:Boolean,required:!1,default:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(i){const o=i,{loop:n}=we(o),{forwardRef:d,currentElement:p}=G(),f=xe();return f.tabsList=p,(c,m)=>(r(),h(e(it),{"as-child":"",orientation:e(f).orientation.value,dir:e(f).dir.value,loop:e(n)},{default:s(()=>[a(e(O),{ref:e(d),role:"tablist","as-child":c.asChild,as:c.as,"aria-orientation":e(f).orientation.value},{default:s(()=>[$(c.$slots,"default")]),_:3},8,["as-child","as","aria-orientation"])]),_:3},8,["orientation","dir","loop"]))}}),ka=ba,wa=V({__name:"TabsTrigger",props:{value:{type:[String,Number],required:!0},disabled:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(i){const o=i,{forwardRef:n}=G(),d=xe(),p=j(()=>Ee(d.baseId,o.value)),f=j(()=>He(d.baseId,o.value)),c=j(()=>o.value===d.modelValue.value);return(m,g)=>(r(),h(e(Qt),{"as-child":"",focusable:!m.disabled,active:c.value},{default:s(()=>[a(e(O),{id:p.value,ref:e(n),role:"tab",type:m.as==="button"?"button":void 0,as:m.as,"as-child":m.asChild,"aria-selected":c.value?"true":"false","aria-controls":f.value,"data-state":c.value?"active":"inactive",disabled:m.disabled,"data-disabled":m.disabled?"":void 0,"data-orientation":e(d).orientation.value,onMousedown:g[0]||(g[0]=pt(v=>{!m.disabled&&v.ctrlKey===!1?e(d).changeModelValue(m.value):v.preventDefault()},["left"])),onKeydown:g[1]||(g[1]=ct(v=>e(d).changeModelValue(m.value),["enter","space"])),onFocus:g[2]||(g[2]=()=>{const v=e(d).activationMode!=="manual";!c.value&&!m.disabled&&v&&e(d).changeModelValue(m.value)})},{default:s(()=>[$(m.$slots,"default")]),_:3},8,["id","type","as","as-child","aria-selected","aria-controls","data-state","disabled","data-disabled","data-orientation"])]),_:3},8,["focusable","active"]))}}),xa=wa;const Re={__name:"DropdownMenuRadioGroup",props:{modelValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["update:modelValue"],setup(i,{emit:o}){const p=fe(i,o);return(f,c)=>(r(),h(e(pa),z({"data-slot":"dropdown-menu-radio-group"},e(p)),{default:s(()=>[$(f.$slots,"default")]),_:3},16))}},$a={class:"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center"},pe={__name:"DropdownMenuRadioItem",props:{value:{type:String,required:!0},disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},class:{type:null,required:!1}},emits:["select"],setup(i,{emit:o}){const n=i,d=o,p=te(n,"class"),f=fe(p,d);return(c,m)=>(r(),h(e(ma),z({"data-slot":"dropdown-menu-radio-item"},e(f),{class:e(ae)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",n.class)}),{default:s(()=>[u("span",$a,[a(e(ia),null,{default:s(()=>[$(c.$slots,"indicator-icon",{},()=>[a(e(Gt),{class:"size-2 fill-current"})])]),_:3})]),$(c.$slots,"default")]),_:3},16,["class"]))}},qa={__name:"Tabs",props:{defaultValue:{type:null,required:!1},orientation:{type:String,required:!1},dir:{type:String,required:!1},activationMode:{type:String,required:!1},modelValue:{type:null,required:!1},unmountOnHide:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},class:{type:null,required:!1}},emits:["update:modelValue"],setup(i,{emit:o}){const n=i,d=o,p=te(n,"class"),f=fe(p,d);return(c,m)=>(r(),h(e(ya),z({"data-slot":"tabs"},e(f),{class:e(ae)("flex flex-col gap-2",n.class)}),{default:s(g=>[$(c.$slots,"default",Y(ee(g)))]),_:3},16,["class"]))}},Fe={__name:"TabsContent",props:{value:{type:[String,Number],required:!0},forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},class:{type:null,required:!1}},setup(i){const o=i,n=te(o,"class");return(d,p)=>(r(),h(e(ha),z({"data-slot":"tabs-content",class:e(ae)("flex-1 outline-none",o.class)},e(n)),{default:s(()=>[$(d.$slots,"default")]),_:3},16,["class"]))}},Ma={__name:"TabsList",props:{loop:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},class:{type:null,required:!1}},setup(i){const o=i,n=te(o,"class");return(d,p)=>(r(),h(e(ka),z({"data-slot":"tabs-list"},e(n),{class:e(ae)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",o.class)}),{default:s(()=>[$(d.$slots,"default")]),_:3},16,["class"]))}},Ae={__name:"TabsTrigger",props:{value:{type:[String,Number],required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},class:{type:null,required:!1}},setup(i){const o=i,n=te(o,"class"),d=ke(n);return(p,f)=>(r(),h(e(xa),z({"data-slot":"tabs-trigger",class:e(ae)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",o.class)},e(d)),{default:s(()=>[$(p.$slots,"default")]),_:3},16,["class"]))}},Ca={class:"max-w-7xl mx-auto space-y-6"},Ia={class:"space-y-4"},Va={key:0,class:"flex justify-between items-start"},Sa={class:"text-3xl font-bold tracking-tight text-slate-900 dark:text-slate-50"},Ta={class:"text-slate-500 dark:text-slate-400 mt-1 max-w-3xl"},Ba={key:1},Da={class:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between bg-white dark:bg-slate-900 p-4 rounded-lg border shadow-sm"},Ra={class:"relative w-full sm:w-72"},Fa={class:"flex gap-2 w-full sm:w-auto"},Aa={class:"flex items-center gap-2"},Pa={class:"truncate"},ja={class:"space-y-4 md:hidden"},La={key:0,class:"space-y-4"},Na={key:1,class:"text-center py-12 text-slate-500 border-2 border-dashed rounded-lg"},za={class:"flex justify-between items-start"},Ea={class:"flex flex-col gap-1"},Ha={key:0,class:"flex flex-wrap gap-1"},Ka={class:"grid gap-2"},Oa={key:0},Ga={class:"text-xs text-slate-500 uppercase tracking-wider font-semibold mb-1"},Ua=["innerHTML"],Wa={key:1,class:"border-t pt-2 mt-1"},Ja={class:"text-xs text-slate-500 uppercase tracking-wider font-semibold mb-1"},Qa=["innerHTML"],Za={class:"hidden md:block rounded-md border bg-white dark:bg-slate-900"},Xa={class:"text-xs text-slate-400 block mb-0.5"},Ya=["innerHTML"],es={class:"text-xs text-slate-400 block mb-0.5"},ts=["innerHTML"],as={class:"flex flex-wrap gap-1"},ss={key:0,class:"py-4"},ls={class:"rounded-lg border bg-white dark:bg-slate-900 p-6 space-y-6"},os={key:0,class:"grid gap-4 max-w-sm"},ns={class:"space-y-2"},rs={class:"space-y-2"},ds={key:1,class:"space-y-4 max-w-sm"},us={class:"pt-6 border-t space-y-4"},is={class:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800 rounded-lg"},cs={class:"pt-6 border-t"},ks={__name:"DeckDetailView",setup(i){const o=vt(),n=ft(),d="https://perfect-nikon-perception-range.trycloudflare.com/api/v1",p=n.params.id,f=w(null),c=w([]),m=w(0),g=w(1),v=w(!0),b=w(""),q=w("desc"),T=w("created_at"),E=w("all"),$e=w([]),Ke=async()=>{const y=localStorage.getItem("auth_token");try{const{data:t}=await H(`${d}/decks/${p}`,{headers:{Authorization:`Bearer ${y}`}}).json();t.value&&(f.value=t.value)}catch{D.error("Failed to load deck")}},Oe=async()=>{const y=localStorage.getItem("auth_token");try{const{data:t}=await H(`${d}/tags?deck_id=${p}&limit=100`,{headers:{Authorization:`Bearer ${y}`}}).json();t.value&&($e.value=t.value.data)}catch{console.error("Failed to load tags")}},U=async()=>{v.value=!0;const y=localStorage.getItem("auth_token");try{const t=new URL(`${d}/decks/${p}/notes`);t.searchParams.append("page",g.value),t.searchParams.append("limit",20),b.value&&t.searchParams.append("search",b.value),E.value&&E.value!=="all"&&t.searchParams.append("tag",E.value),t.searchParams.append("sort",T.value),t.searchParams.append("order",q.value);const{data:l}=await H(t.toString(),{headers:{Authorization:`Bearer ${y}`}}).json();l.value&&(c.value=l.value.data,m.value=l.value.meta.total,g.value=l.value.meta.current_page)}catch{D.error("Failed to load cards")}finally{v.value=!1}},Ge=yt(()=>{g.value=1,U()},500),me=()=>{g.value=1,U()},se=w(null),le=w(!1),oe=w(!1),qe=y=>{se.value=y,le.value=!0},Ue=async()=>{if(!se.value)return;oe.value=!0;const y=localStorage.getItem("auth_token"),t=se.value.id;try{await H(`${d}/notes/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${y}`}}),c.value=c.value.filter(l=>l.id!==t),m.value--,D.success("Note deleted")}catch{D.error("Failed to delete note")}finally{oe.value=!1,le.value=!1,se.value=null}},Me=y=>{o.push(`/cards/${y}/edit`)},We=()=>{o.push(`/decks/${p}/add`)},L=w({title:"",description:""}),ne=w(!1),re=w(!1),Je=async()=>{ne.value=!0;const y=localStorage.getItem("auth_token");try{const{error:t}=await H(`${d}/decks/${p}`,{method:"PUT",headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"},body:JSON.stringify(L.value)}).json();if(t.value)throw new Error("Update failed");D.success("Deck updated"),f.value&&(f.value.title=L.value.title,f.value.description=L.value.description)}catch{D.error("Failed to update deck")}finally{ne.value=!1}},de=w(!1),Qe=async()=>{de.value=!0;const y=localStorage.getItem("auth_token");try{const{data:t}=await H(`${d}/decks/${p}/sync`,{method:"POST",headers:{Authorization:`Bearer ${y}`}}).json();t.value&&(D.success(t.value.message),U())}catch{D.error("Sync failed")}finally{de.value=!1}},Ze=async()=>{if(!confirm("Are you absolutely sure? This will delete all cards in this deck."))return;re.value=!0;const y=localStorage.getItem("auth_token");try{const{error:t}=await H(`${d}/decks/${p}`,{method:"DELETE",headers:{Authorization:`Bearer ${y}`}});if(t.value)throw new Error("Delete failed");D.success("Deck deleted"),o.push("/decks")}catch{D.error("Failed to delete deck"),re.value=!1}};he(async()=>{await Promise.all([Ke(),U(),Oe()])}),mt(f,y=>{y&&(L.value={title:y.title,description:y.description})},{immediate:!0});const W=y=>{if(!y.fields)return{label:"Front",content:"N/A"};const t=["pos","part of speech","id","audio","sound","image","picture","note","notes"],l=["expression","vocabulary","vocab","word","kanji","term","front","question","kana"],M=Object.keys(y.fields),C=M.reduce((x,Q)=>(x[Q.toLowerCase()]=Q,x),{});for(const x of l)if(C[x])return{label:C[x],content:X(y.fields[C[x]])};for(const x of M)if(!t.includes(x.toLowerCase()))return{label:x,content:X(y.fields[x])};const R=M[0];return{label:R||"Front",content:X(y.fields[R]||"N/A")}},J=y=>{if(!y.fields)return{label:"Back",content:""};const t=["audio","sound","image","picture"],l=["meaning","definition","english","reading","back","answer","glossary"],M=Object.keys(y.fields),C=M.reduce((x,Q)=>(x[Q.toLowerCase()]=Q,x),{});for(const x of l)if(C[x])return{label:C[x],content:X(y.fields[C[x]])};const R=M.filter(x=>!t.includes(x.toLowerCase()));return R.length>1?{label:R[1],content:X(y.fields[R[1]])}:{label:"Back",content:""}};return(y,t)=>(r(),k("div",Ca,[u("div",Ia,[a(e(F),{variant:"ghost",class:"pl-0 gap-2 text-slate-500 hover:text-slate-900 dark:hover:text-slate-100",onClick:t[0]||(t[0]=l=>e(o).push("/decks"))},{default:s(()=>[a(e(Ht),{class:"w-4 h-4"}),t[9]||(t[9]=_(" Back to Decks ",-1))]),_:1}),f.value?(r(),k("div",Va,[u("div",null,[u("h1",Sa,I(f.value.title),1),u("p",Ta,I(f.value.description),1)]),a(e(F),{class:"gap-2",onClick:We},{default:s(()=>[a(e(St),{class:"w-4 h-4"}),t[10]||(t[10]=_(" Add Card ",-1))]),_:1})])):v.value?(r(),k("div",Ba,[a(e(B),{class:"h-10 w-1/3 mb-2"}),a(e(B),{class:"h-4 w-1/2"})])):P("",!0)]),a(e(qa),{defaultValue:"cards",class:"w-full"},{default:s(()=>[a(e(Ma),{class:"mb-4"},{default:s(()=>[a(e(Ae),{value:"cards",class:"gap-2"},{default:s(()=>[a(e(Ut),{class:"w-4 h-4"}),t[11]||(t[11]=_(" Cards ",-1))]),_:1}),a(e(Ae),{value:"settings",class:"gap-2"},{default:s(()=>[a(e(_t),{class:"w-4 h-4"}),t[12]||(t[12]=_(" Settings ",-1))]),_:1})]),_:1}),a(e(Fe),{value:"cards",class:"space-y-4"},{default:s(()=>[u("div",Da,[u("div",Ra,[a(e(Tt),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-slate-500"}),a(e(Ce),{placeholder:"Search cards...",class:"pl-9",modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=l=>b.value=l),onInput:e(Ge)},null,8,["modelValue","onInput"])]),u("div",Fa,[a(e(Nt),{modelValue:E.value,"onUpdate:modelValue":[t[2]||(t[2]=l=>E.value=l),me]},{default:s(()=>[a(e(zt),{class:"w-[150px]"},{default:s(()=>[u("div",Aa,[a(e(Wt),{class:"w-3.5 h-3.5"}),u("span",Pa,I(E.value==="all"?"All Tags":E.value),1)])]),_:1}),a(e(Et),null,{default:s(()=>[a(e(Te),{value:"all"},{default:s(()=>[...t[13]||(t[13]=[_("All Tags",-1)])]),_:1}),(r(!0),k(A,null,N($e.value,l=>(r(),h(e(Te),{key:l.id,value:l.name},{default:s(()=>[_(I(l.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),a(e(ve),null,{default:s(()=>[a(e(_e),{"as-child":""},{default:s(()=>[a(e(F),{variant:"outline",class:"gap-2"},{default:s(()=>[q.value==="asc"?(r(),h(e(Ot),{key:0,class:"w-4 h-4"})):(r(),h(e(Kt),{key:1,class:"w-4 h-4"})),t[14]||(t[14]=_(" Sort ",-1))]),_:1})]),_:1}),a(e(ye),{align:"end",class:"w-48"},{default:s(()=>[a(e(Ie),null,{default:s(()=>[...t[15]||(t[15]=[_("Sort By",-1)])]),_:1}),a(e(Ve)),a(e(Re),{modelValue:T.value,"onUpdate:modelValue":[t[3]||(t[3]=l=>T.value=l),me]},{default:s(()=>[a(e(pe),{value:"created_at"},{default:s(()=>[...t[16]||(t[16]=[_("Created Date",-1)])]),_:1}),a(e(pe),{value:"updated_at"},{default:s(()=>[...t[17]||(t[17]=[_("Updated Date",-1)])]),_:1})]),_:1},8,["modelValue"]),a(e(Ve)),a(e(Ie),null,{default:s(()=>[...t[18]||(t[18]=[_("Order",-1)])]),_:1}),a(e(Re),{modelValue:q.value,"onUpdate:modelValue":[t[4]||(t[4]=l=>q.value=l),me]},{default:s(()=>[a(e(pe),{value:"desc"},{default:s(()=>[...t[19]||(t[19]=[_("Newest First",-1)])]),_:1}),a(e(pe),{value:"asc"},{default:s(()=>[...t[20]||(t[20]=[_("Oldest First",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),u("div",ja,[v.value?(r(),k("div",La,[(r(),k(A,null,N(3,l=>a(e(B),{key:l,class:"h-32 w-full rounded-lg"})),64))])):c.value.length===0?(r(),k("div",Na," No cards found. Start by adding one! ")):(r(!0),k(A,{key:2},N(c.value,l=>(r(),k("div",{key:l.id,class:"rounded-lg border bg-white dark:bg-slate-900 p-4 space-y-3 shadow-sm"},[u("div",za,[u("div",Ea,[a(e(ue),{variant:"secondary",class:"text-xs shrink-0 self-start"},{default:s(()=>[_(I(l.note_type?.name||"Card"),1)]),_:2},1024),l.tags&&l.tags.length>0?(r(),k("div",Ha,[(r(!0),k(A,null,N(l.tags,M=>(r(),h(e(ue),{key:M.id,variant:"outline",class:"text-[10px] px-1 py-0 h-4"},{default:s(()=>[_(I(M.name),1)]),_:2},1024))),128))])):P("",!0)]),a(e(ve),null,{default:s(()=>[a(e(_e),{"as-child":""},{default:s(()=>[a(e(F),{variant:"ghost",class:"h-8 w-8 p-0 -mr-2 -mt-2 text-slate-400"},{default:s(()=>[t[21]||(t[21]=u("span",{class:"sr-only"},"Open menu",-1)),a(e(Se),{class:"h-4 w-4"})]),_:1})]),_:1}),a(e(ye),{align:"end"},{default:s(()=>[a(e(ie),{onClick:M=>Me(l.id)},{default:s(()=>[a(e(Be),{class:"mr-2 h-4 w-4"}),t[22]||(t[22]=_(" Edit ",-1))]),_:1},8,["onClick"]),a(e(ie),{onClick:M=>qe(l),class:"text-red-600 focus:text-red-600"},{default:s(()=>[a(e(De),{class:"mr-2 h-4 w-4"}),t[23]||(t[23]=_(" Delete ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),u("div",Ka,[W(l).content?(r(),k("div",Oa,[u("div",Ga,I(W(l).label),1),u("div",{class:"font-medium text-lg leading-snug break-words",innerHTML:W(l).content},null,8,Ua)])):P("",!0),J(l).content?(r(),k("div",Wa,[u("div",Ja,I(J(l).label),1),u("div",{class:"text-slate-600 dark:text-slate-300 leading-snug break-words",innerHTML:J(l).content},null,8,Qa)])):P("",!0)])]))),128))]),u("div",Za,[a(e(ht),null,{default:s(()=>[a(e(bt),null,{default:s(()=>[a(e(ce),null,{default:s(()=>[a(e(Z),{class:"w-[30%]"},{default:s(()=>[...t[24]||(t[24]=[_("Front",-1)])]),_:1}),a(e(Z),{class:"w-[30%]"},{default:s(()=>[...t[25]||(t[25]=[_("Back",-1)])]),_:1}),a(e(Z),{class:"w-[15%]"},{default:s(()=>[...t[26]||(t[26]=[_("Type",-1)])]),_:1}),a(e(Z),{class:"w-[15%]"},{default:s(()=>[...t[27]||(t[27]=[_("Tags",-1)])]),_:1}),a(e(Z),{class:"text-right w-[10%]"},{default:s(()=>[...t[28]||(t[28]=[_("Actions",-1)])]),_:1})]),_:1})]),_:1}),a(e(kt),null,{default:s(()=>[v.value?(r(),k(A,{key:0},N(5,l=>a(e(ce),{key:l},{default:s(()=>[a(e(S),null,{default:s(()=>[a(e(B),{class:"h-4 w-20"})]),_:1}),a(e(S),null,{default:s(()=>[a(e(B),{class:"h-4 w-32"})]),_:1}),a(e(S),null,{default:s(()=>[a(e(B),{class:"h-4 w-16"})]),_:1}),a(e(S),null,{default:s(()=>[a(e(B),{class:"h-4 w-16"})]),_:1}),a(e(S),null,{default:s(()=>[a(e(B),{class:"h-8 w-8 ml-auto"})]),_:1})]),_:1})),64)):c.value.length===0?(r(),h(e(ce),{key:1},{default:s(()=>[a(e(S),{colspan:"5",class:"h-24 text-center"},{default:s(()=>[...t[29]||(t[29]=[_(" No cards found. Start by adding one! ",-1)])]),_:1})]),_:1})):(r(!0),k(A,{key:2},N(c.value,l=>(r(),h(e(ce),{key:l.id},{default:s(()=>[a(e(S),{class:"font-medium truncate max-w-[250px] align-top"},{default:s(()=>[u("span",Xa,I(W(l).label),1),u("span",{innerHTML:W(l).content},null,8,Ya)]),_:2},1024),a(e(S),{class:"truncate max-w-[250px] align-top"},{default:s(()=>[u("span",es,I(J(l).label),1),u("span",{innerHTML:J(l).content},null,8,ts)]),_:2},1024),a(e(S),{class:"align-top"},{default:s(()=>[a(e(ue),{variant:"secondary",class:"text-xs whitespace-nowrap"},{default:s(()=>[_(I(l.note_type?.name||"Card"),1)]),_:2},1024)]),_:2},1024),a(e(S),{class:"align-top"},{default:s(()=>[u("div",as,[(r(!0),k(A,null,N(l.tags,M=>(r(),h(e(ue),{key:M.id,variant:"outline",class:"text-[10px] px-1 h-5 whitespace-nowrap"},{default:s(()=>[_(I(M.name),1)]),_:2},1024))),128))])]),_:2},1024),a(e(S),{class:"text-right align-top"},{default:s(()=>[a(e(ve),null,{default:s(()=>[a(e(_e),{"as-child":""},{default:s(()=>[a(e(F),{variant:"ghost",class:"h-8 w-8 p-0"},{default:s(()=>[t[30]||(t[30]=u("span",{class:"sr-only"},"Open menu",-1)),a(e(Se),{class:"h-4 w-4"})]),_:1})]),_:1}),a(e(ye),{align:"end"},{default:s(()=>[a(e(ie),{onClick:M=>Me(l.id)},{default:s(()=>[a(e(Be),{class:"mr-2 h-4 w-4"}),t[31]||(t[31]=_(" Edit ",-1))]),_:1},8,["onClick"]),a(e(ie),{onClick:M=>qe(l),class:"text-red-600 focus:text-red-600"},{default:s(()=>[a(e(De),{class:"mr-2 h-4 w-4"}),t[32]||(t[32]=_(" Delete ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),m.value>20?(r(),k("div",ss,[a(e(Bt),{total:m.value,"sibling-count":1,"show-edges":"","default-page":1,"items-per-page":20,"onUpdate:page":t[5]||(t[5]=l=>{g.value=l,U()})},{default:s(({page:l})=>[a(e(Dt),{class:"flex items-center gap-1 justify-center"},{default:s(({items:M})=>[a(e(Rt)),a(e(Ft)),(r(!0),k(A,null,N(M,(C,R)=>(r(),k(A,null,[C.type==="page"?(r(),h(e(At),{key:R,value:C.value,"as-child":""},{default:s(()=>[a(e(F),{class:"w-9 h-9 p-0",variant:C.value===l?"default":"outline"},{default:s(()=>[_(I(C.value),1)]),_:2},1032,["variant"])]),_:2},1032,["value"])):(r(),h(e(Pt),{key:C.type,index:R},null,8,["index"]))],64))),256)),a(e(jt)),a(e(Lt))]),_:2},1024)]),_:1},8,["total"])])):P("",!0)]),_:1}),a(e(Fe),{value:"settings"},{default:s(()=>[u("div",ls,[t[42]||(t[42]=u("div",null,[u("h3",{class:"text-lg font-medium"},"Deck Settings"),u("p",{class:"text-sm text-slate-500"},"Manage your deck's preferences.")],-1)),f.value?(r(),k("div",os,[u("div",ns,[t[33]||(t[33]=u("label",{class:"text-sm font-medium"},"Deck Title",-1)),a(e(Ce),{modelValue:L.value.title,"onUpdate:modelValue":t[6]||(t[6]=l=>L.value.title=l)},null,8,["modelValue"])]),u("div",rs,[t[34]||(t[34]=u("label",{class:"text-sm font-medium"},"Description",-1)),a(e(gt),{modelValue:L.value.description,"onUpdate:modelValue":t[7]||(t[7]=l=>L.value.description=l),class:"resize-none h-32"},null,8,["modelValue"])]),a(e(F),{onClick:Je,disabled:ne.value},{default:s(()=>[ne.value?(r(),h(e(ge),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):P("",!0),t[35]||(t[35]=_(" Save Changes ",-1))]),_:1},8,["disabled"])])):(r(),k("div",ds,[a(e(B),{class:"h-10 w-full"}),a(e(B),{class:"h-32 w-full"})])),u("div",us,[t[38]||(t[38]=u("h3",{class:"text-lg font-medium"},"Maintenance",-1)),u("div",is,[t[37]||(t[37]=u("div",null,[u("div",{class:"font-medium text-slate-900 dark:text-slate-100"},"Sync Cards"),u("div",{class:"text-sm text-slate-500"},"Fix missing cards if deck seems empty but has notes.")],-1)),a(e(F),{variant:"outline",onClick:Qe,disabled:de.value},{default:s(()=>[de.value?(r(),h(e(ge),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):P("",!0),t[36]||(t[36]=_(" Repair & Sync ",-1))]),_:1},8,["disabled"])])]),u("div",cs,[t[40]||(t[40]=u("h3",{class:"text-lg font-medium text-red-600"},"Danger Zone",-1)),t[41]||(t[41]=u("p",{class:"text-sm text-slate-500 mb-4"},"Once you delete a deck, there is no going back.",-1)),a(e(F),{variant:"destructive",onClick:Ze,disabled:re.value},{default:s(()=>[re.value?(r(),h(e(ge),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):P("",!0),t[39]||(t[39]=_(" Delete Deck ",-1))]),_:1},8,["disabled"])])])]),_:1})]),_:1}),a(e(Vt),{open:le.value,"onUpdate:open":t[8]||(t[8]=l=>le.value=l)},{default:s(()=>[a(e(wt),null,{default:s(()=>[a(e(xt),null,{default:s(()=>[a(e($t),null,{default:s(()=>[...t[43]||(t[43]=[_("Delete this card?",-1)])]),_:1}),a(e(qt),null,{default:s(()=>[...t[44]||(t[44]=[_(" This will permanently remove this note and its associated cards from the deck. ",-1)])]),_:1})]),_:1}),a(e(Mt),null,{default:s(()=>[a(e(Ct),{disabled:oe.value},{default:s(()=>[...t[45]||(t[45]=[_("Cancel",-1)])]),_:1},8,["disabled"]),a(e(It),{onClick:Ue,disabled:oe.value,class:"bg-red-600 hover:bg-red-700 focus:ring-red-600 text-white"},{default:s(()=>[...t[46]||(t[46]=[_(" Delete ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]))}};export{ks as default};
