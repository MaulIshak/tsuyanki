import{h as u,O as W,i as Y,l as c,p as n,s as j,q as s,w as a,x as o,u as e,N as X,B as v,G as F,F as S,D as N,t as M,H as V,y as R,A as q,L as I,b as B,v as Z,E as m,Q as ee,R as te,S as k,T as se,U,I as ae,V as le,J as O,K as H,j as oe,o as i,W as ne}from"./index-D72fFMdT.js";import{_ as ie}from"./CardFooter-DeXfPyl4.js";import{P as re,S as de,E as ue,_ as ce,a as fe,b as me,c as _e,d as pe,e as ve,f as ge,g as xe}from"./PaginationPrevious-B5mNzCOh.js";import{_ as ke,a as be,b as ye,c as he,d as $e,e as we,f as De,g as Ce}from"./AlertDialogTitle-CKJhpHME.js";import{_ as Se,a as Ve,b as Ee,c as Le,d as je,e as Ne}from"./DialogTitle-C0nU9RZj.js";import{_ as Be}from"./Label-BMHaunIF.js";import"./DialogTitle-CB7R-MTF.js";const Ue={class:"p-4 lg:p-6 space-y-6 max-w-7xl mx-auto"},Ae={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},Pe={class:"relative w-full max-w-md"},Te={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},ze={key:1,class:"text-center py-20 bg-slate-50 dark:bg-slate-900/50 rounded-lg border border-dashed border-slate-300 dark:border-slate-800"},Fe={class:"w-16 h-16 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4"},Me={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},Re={class:"space-y-1 pr-4"},qe={class:"text-sm text-slate-500 dark:text-slate-400 line-clamp-2 min-h-[2.5em] leading-relaxed"},Ie={class:"flex items-center justify-between mt-auto"},Oe={class:"flex items-center gap-1.5 opacity-80"},He={key:3,class:"flex justify-center pt-8 pb-4"},Qe={key:0,class:"font-bold text-slate-900 dark:text-slate-100"},Ge={class:"grid gap-4 py-4"},Je={class:"grid grid-cols-4 items-center gap-4"},Ke={key:0,class:"col-span-4 text-xs text-slate-500 text-right"},lt={__name:"DeckListView",setup(We){const b=X();oe();const A="https://perfect-nikon-perception-range.trycloudflare.com/api/v1",g=u([]),y=u(0),h=u(1),$=u(""),E=u(!0),_=u(null),w=u(20),D=u(!1),P=f=>{_.value=f,w.value=20,D.value=!0},Q=()=>{_.value&&(D.value=!1,b.push({path:"/study",query:{deck_id:_.value.id,limit:w.value}}))},L=async()=>{E.value=!0;const f=localStorage.getItem("auth_token"),t=h.value,l=$.value,d=new URL(`${A}/decks`);d.searchParams.append("page",t),d.searchParams.append("limit",6),l&&d.searchParams.append("search",l);try{const{data:r}=await O(d.toString(),{headers:{Authorization:`Bearer ${f}`}}).json();r.value&&(g.value=r.value.data,y.value=r.value.meta.total,h.value=r.value.meta.current_page)}catch(r){console.error(r)}finally{E.value=!1}},G=ne(()=>{h.value=1,L()},500);W($,G),Y(()=>{L()});const p=u(null),C=u(!1),x=u(!1),J=f=>{p.value=f,C.value=!0},K=async()=>{if(!p.value)return;x.value=!0;const f=localStorage.getItem("auth_token");try{const{error:t}=await O(`${A}/decks/${p.value.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${f}`}});if(t.value)throw new Error("Delete failed");H.success("Deck deleted"),g.value=g.value.filter(l=>l.id!==p.value.id),y.value--}catch{H.error("Failed to delete deck")}finally{x.value=!1,C.value=!1,p.value=null}},T=f=>{b.push(`/decks/${f}`)};return(f,t)=>(i(),c("div",Ue,[n("div",Ae,[t[9]||(t[9]=n("div",null,[n("h1",{class:"text-3xl font-bold tracking-tight text-slate-900 dark:text-slate-50"},"My Decks"),n("p",{class:"text-slate-500 dark:text-slate-400"},"Manage your flashcard collections.")],-1)),s(e(v),{onClick:t[0]||(t[0]=l=>e(b).push("/decks/create")),class:"gap-2"},{default:a(()=>[s(e(re),{class:"w-4 h-4"}),t[8]||(t[8]=o(" Create Deck ",-1))]),_:1})]),n("div",Pe,[s(e(de),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-slate-400"}),s(e(F),{modelValue:$.value,"onUpdate:modelValue":t[1]||(t[1]=l=>$.value=l),type:"search",placeholder:"Search decks...",class:"pl-8 bg-white dark:bg-slate-900"},null,8,["modelValue"])]),E.value?(i(),c("div",Te,[(i(),c(S,null,N(6,l=>s(e(q),{key:l,class:"overflow-hidden"},{default:a(()=>[s(e(M),{class:"pb-2"},{default:a(()=>[s(e(V),{class:"h-6 w-3/4 mb-2"}),s(e(V),{class:"h-4 w-1/2"})]),_:1}),s(e(R),null,{default:a(()=>[s(e(V),{class:"h-4 w-full mb-2"}),s(e(V),{class:"h-4 w-2/3"})]),_:1})]),_:1})),64))])):g.value.length===0?(i(),c("div",ze,[n("div",Fe,[s(e(I),{class:"w-8 h-8 text-slate-400"})]),t[11]||(t[11]=n("h3",{class:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-2"},"No decks found",-1)),t[12]||(t[12]=n("p",{class:"text-slate-500 dark:text-slate-400 mb-6 max-w-sm mx-auto"},"You haven't created any decks yet, or your search returned no results.",-1)),s(e(v),{onClick:t[2]||(t[2]=l=>e(b).push("/decks/create")),variant:"outline"},{default:a(()=>[...t[10]||(t[10]=[o("Create your first deck",-1)])]),_:1})])):(i(),c("div",Me,[(i(!0),c(S,null,N(g.value,l=>(i(),B(e(q),{key:l.id,class:"group bg-white/90 dark:bg-slate-900/40 backdrop-blur-sm border-slate-200/60 dark:border-slate-800/60 hover:border-indigo-400 dark:hover:border-indigo-500 transition-all duration-300 cursor-pointer flex flex-col hover:shadow-lg hover:-translate-y-1",onClick:d=>T(l.id)},{default:a(()=>[s(e(M),{class:"flex flex-row items-start justify-between space-y-0 pb-2"},{default:a(()=>[n("div",Re,[s(e(Z),{class:"text-lg font-bold line-clamp-1 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors"},{default:a(()=>[o(m(l.title),1)]),_:2},1024),n("p",qe,m(l.description||"No description provided."),1)]),s(e(ee),null,{default:a(()=>[s(e(te),{"as-child":""},{default:a(()=>[s(e(v),{variant:"ghost",size:"icon",class:"-mt-1 -mr-2 h-8 w-8 text-slate-400 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors",onClick:t[3]||(t[3]=k(()=>{},["stop"]))},{default:a(()=>[s(e(ue),{class:"w-4 h-4"})]),_:1})]),_:1}),s(e(se),{align:"end",class:"w-48"},{default:a(()=>[s(e(U),{onClick:k(d=>T(l.id),["stop"])},{default:a(()=>[...t[13]||(t[13]=[o("Edit Deck",-1)])]),_:1},8,["onClick"]),s(e(U),{onClick:k(d=>P(l),["stop"])},{default:a(()=>[...t[14]||(t[14]=[o("Study Now",-1)])]),_:1},8,["onClick"]),s(e(U),{onClick:k(d=>J(l),["stop"]),class:"text-red-600 focus:text-red-600"},{default:a(()=>[...t[15]||(t[15]=[o("Delete",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024),s(e(R),{class:"flex-1 p-4 pt-2"},{default:a(()=>[n("div",Ie,[s(e(ae),{variant:"secondary",class:"font-normal bg-indigo-50 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 hover:bg-indigo-100 transition-colors"},{default:a(()=>[s(e(I),{class:"w-3 h-3 mr-1"}),o(" "+m(l.notes_count||0)+" cards ",1)]),_:2},1024)])]),_:2},1024),s(e(ie),{class:"border-t border-slate-100 dark:border-slate-800 bg-slate-50/30 dark:bg-slate-900/20 p-4 text-xs text-slate-500 dark:text-slate-400 flex justify-between items-center"},{default:a(()=>[n("div",Oe,[s(e(le),{class:"w-3 h-3"}),t[16]||(t[16]=n("span",null,"Last: Never",-1))]),s(e(v),{size:"sm",class:"h-7 text-xs bg-indigo-50 hover:bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:hover:bg-indigo-800 dark:text-indigo-200 border-0 transition-colors shadow-sm",onClick:k(d=>P(l),["stop"])},{default:a(()=>[...t[17]||(t[17]=[o(" Study ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))])),y.value>6?(i(),c("div",He,[s(e(xe),{total:y.value,"sibling-count":1,"show-edges":"","default-page":1,"items-per-page":6,"onUpdate:page":t[4]||(t[4]=l=>{h.value=l,L()})},{default:a(({page:l})=>[s(e(ce),{class:"flex items-center gap-1"},{default:a(({items:d})=>[s(e(fe)),s(e(me)),(i(!0),c(S,null,N(d,(r,z)=>(i(),c(S,null,[r.type==="page"?(i(),B(e(_e),{key:z,value:r.value,"as-child":""},{default:a(()=>[s(e(v),{class:"w-10 h-10 p-0",variant:r.value===l?"default":"outline"},{default:a(()=>[o(m(r.value),1)]),_:2},1032,["variant"])]),_:2},1032,["value"])):(i(),B(e(pe),{key:r.type,index:z},null,8,["index"]))],64))),256)),s(e(ve)),s(e(ge))]),_:2},1024)]),_:1},8,["total"])])):j("",!0),s(e(Ce),{open:C.value,"onUpdate:open":t[5]||(t[5]=l=>C.value=l)},{default:a(()=>[s(e(ke),null,{default:a(()=>[s(e(be),null,{default:a(()=>[s(e(ye),null,{default:a(()=>[...t[18]||(t[18]=[o("Are you absolutely sure?",-1)])]),_:1}),s(e(he),null,{default:a(()=>[t[19]||(t[19]=o(" This action cannot be undone. This will permanently delete the deck ",-1)),p.value?(i(),c("span",Qe,'"'+m(p.value.title)+'"',1)):j("",!0),t[20]||(t[20]=o(" and all its cards. ",-1))]),_:1})]),_:1}),s(e($e),null,{default:a(()=>[s(e(we),{disabled:x.value},{default:a(()=>[...t[21]||(t[21]=[o("Cancel",-1)])]),_:1},8,["disabled"]),s(e(De),{onClick:K,disabled:x.value,class:"bg-red-600 hover:bg-red-700 focus:ring-red-600 text-white"},{default:a(()=>[o(m(x.value?"Deleting...":"Delete"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),s(e(Ne),{open:D.value,"onUpdate:open":t[7]||(t[7]=l=>D.value=l)},{default:a(()=>[s(e(Se),{class:"sm:max-w-[425px]"},{default:a(()=>[s(e(Ve),null,{default:a(()=>[s(e(Ee),null,{default:a(()=>[o('Study "'+m(_.value?.title)+'"',1)]),_:1}),s(e(Le),null,{default:a(()=>[...t[22]||(t[22]=[o(" How many cards would you like to review in this session? ",-1)])]),_:1})]),_:1}),n("div",Ge,[n("div",Je,[s(e(Be),{for:"limit",class:"text-right"},{default:a(()=>[...t[23]||(t[23]=[o(" Cards ",-1)])]),_:1}),s(e(F),{id:"limit",modelValue:w.value,"onUpdate:modelValue":t[6]||(t[6]=l=>w.value=l),type:"number",min:"1",max:_.value?.notes_count||100,class:"col-span-3"},null,8,["modelValue","max"]),_.value?(i(),c("p",Ke," Max available: "+m(_.value.notes_count),1)):j("",!0)])]),s(e(je),null,{default:a(()=>[s(e(v),{onClick:Q},{default:a(()=>[...t[24]||(t[24]=[o("Start Session",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]))}};export{lt as default};
