import{c as T,d as f,z as o,B as q,O as y,u as t,I as z,aI as te,r as b,e as s,f as a,Q as ae,R as le,g as $,C as U,t as m,w as l,n as P,m as E,T as N,h as r,p as R,W as A,j as D,aJ as L,a1 as se,l as S,i as re,q as oe,v as de,x as j}from"./index-DhmeCW2F.js";import{_ as G}from"./CardDescription-BcpG3PZw.js";import{_ as O}from"./CardFooter-DtCFFoNU.js";import{_ as ne}from"./Progress-BkZB-F1d.js";import{_ as ie,a as ue,b as I,c as M,d as fe,e as c}from"./TableHeader-D9szp-BW.js";const W=T("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const me=T("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);const ce=T("file-type",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11 18h2",key:"12mj7e"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M9 13v-.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v.5",key:"qbrxap"}]]),Y={__name:"Alert",props:{class:{type:null,required:!1},variant:{type:String,required:!1}},setup(v){const g=te("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),x=v;return(d,F)=>(o(),f("div",{class:y(t(z)(t(g)({variant:v.variant}),x.class)),role:"alert"},[q(d.$slots,"default")],2))}},J={__name:"AlertTitle",props:{class:{type:null,required:!1}},setup(v){const g=v;return(x,d)=>(o(),f("h5",{class:y(t(z)("mb-1 font-medium leading-none tracking-tight",g.class))},[q(x.$slots,"default")],2))}},Q={__name:"AlertDescription",props:{class:{type:null,required:!1}},setup(v){const g=v;return(x,d)=>(o(),f("div",{class:y(t(z)("text-sm [&_p]:leading-relaxed",g.class))},[q(x.$slots,"default")],2))}},pe={class:"p-4 sm:p-6 max-w-3xl mx-auto space-y-6 sm:space-y-8"},ve={class:"grid grid-cols-3 gap-4"},ge={key:1},xe={class:"font-medium text-sm hidden sm:block"},ke={key:0,class:"animate-in fade-in slide-in-from-bottom-4 duration-500"},be={class:"flex flex-col items-center gap-4 text-center"},ye={key:0},_e={class:"font-semibold text-lg text-emerald-700 dark:text-emerald-400"},we={class:"text-sm text-slate-500"},he={key:1},$e={key:1,class:"py-12 px-6 flex flex-col items-center justify-center text-center animate-in fade-in zoom-in-95 duration-500"},Ie={class:"relative mb-8"},Ce={class:"absolute inset-0 flex items-center justify-center font-bold text-xs"},Ae={class:"w-full max-w-md space-y-2"},De={class:"flex justify-between text-xs text-slate-400"},Se={key:2,class:"animate-in fade-in slide-in-from-right-4 duration-500"},je={class:"flex items-center gap-4"},Me={class:"p-2 bg-emerald-100 text-emerald-600 rounded-full dark:bg-emerald-900/30"},Be={__name:"ImportView",setup(v){const g=re(),x="https://activities-associates-involving-soul.trycloudflare.com/api/v1",d=b(0),F=[{id:0,title:"Upload",description:"Select your Anki package"},{id:1,title:"Importing",description:"Processing data"},{id:2,title:"Summary",description:"Review results"}],u=b(null),w=b(!1),C=b(!1),p=b(0),_=b(null),k=b(null),H=n=>{const e=n.target.files[0];V(e)},K=n=>{w.value=!1;const e=n.dataTransfer.files[0];V(e)},V=n=>{n&&n.name.endsWith(".apkg")?(u.value=n,k.value=null):j.error("Invalid file type",{description:"Please select a valid .apkg file"})},X=()=>{u.value=null,_.value=null,k.value=null,d.value=0,p.value=0},Z=async()=>{if(!u.value)return;d.value=1,C.value=!0,k.value=null,p.value=10;const n=setInterval(()=>{p.value<90&&(p.value+=5)},200),e=new FormData;e.append("file",u.value);const i=localStorage.getItem("auth_token");try{const{data:h,response:ee,error:B}=await de(`${x}/import/anki`,{method:"POST",body:e,headers:{Authorization:`Bearer ${i}`}}).json();if(clearInterval(n),p.value=100,B.value||!ee.value.ok)throw new Error(h.value?.message||B.value||"Upload failed");setTimeout(()=>{_.value=h.value,d.value=2,C.value=!1,j.success("Import successful!")},500)}catch(h){clearInterval(n),C.value=!1,d.value=0,k.value=h.message||"An unexpected error occurred during import.",j.error("Import failed",{description:k.value})}};return(n,e)=>(o(),f("div",pe,[e[30]||(e[30]=s("div",{class:"flex items-center gap-4"},[s("div",null,[s("h1",{class:"text-2xl sm:text-3xl font-bold tracking-tight text-slate-900 dark:text-slate-50"},"Import from Anki"),s("p",{class:"text-slate-500 dark:text-slate-400"},"Migrate your decks and cards effortlessly.")])],-1)),s("div",ve,[(o(),f(ae,null,le(F,i=>s("div",{key:i.id,class:"flex flex-col gap-2"},[s("div",{class:y(["flex items-center gap-2",d.value>=i.id?"text-primary":"text-slate-400"])},[s("div",{class:y(["flex h-8 w-8 items-center justify-center rounded-full border-2 text-sm font-semibold transition-colors",d.value>=i.id?"border-primary bg-primary text-primary-foreground":"border-slate-200 bg-transparent"])},[d.value>i.id?(o(),$(t(U),{key:0,class:"w-4 h-4"})):(o(),f("span",ge,m(i.id+1),1))],2),s("span",xe,m(i.title),1)],2),e[4]||(e[4]=s("div",{class:"h-1 w-full rounded-full bg-slate-100 dark:bg-slate-800 absolute bottom-0 left-0 hidden"},null,-1))])),64))]),a(t(oe),{class:"overflow-hidden shadow-lg border-slate-200 dark:border-slate-800 transition-all duration-300"},{default:l(()=>[d.value===0?(o(),f("div",ke,[a(t(E),{class:"mb-2"},{default:l(()=>[a(t(N),null,{default:l(()=>[...e[5]||(e[5]=[r("Select File",-1)])]),_:1}),a(t(G),null,{default:l(()=>[...e[6]||(e[6]=[r("Upload an .apkg file exported from Anki. This will import notes, cards, and media.",-1)])]),_:1})]),_:1}),a(t(R),{class:"space-y-6"},{default:l(()=>[a(t(Y),{variant:"default",class:"bg-blue-50 border-blue-200 text-blue-800 dark:bg-blue-950/30 dark:border-blue-900 dark:text-blue-300"},{default:l(()=>[a(t(W),{class:"h-4 w-4"}),a(t(J),null,{default:l(()=>[...e[7]||(e[7]=[r("Important",-1)])]),_:1}),a(t(Q),null,{default:l(()=>[...e[8]||(e[8]=[r(" Importing is a safe operation. It will create new decks and cards. Your existing Tsuyanki decks will not be overwritten unless they share exact IDs (which is rare). ",-1)])]),_:1})]),_:1}),s("div",{class:y(["relative border-2 border-dashed rounded-xl p-6 sm:p-12 transition-all cursor-pointer group",[w.value?"border-primary bg-primary/5 scale-[1.01]":"border-slate-200 hover:border-primary/50 hover:bg-slate-50 dark:border-slate-800 dark:hover:bg-slate-900",u.value?"bg-emerald-50/50 border-emerald-200 dark:bg-emerald-900/10 dark:border-emerald-800":""]]),onDragover:e[0]||(e[0]=A(i=>w.value=!0,["prevent"])),onDragleave:e[1]||(e[1]=A(i=>w.value=!1,["prevent"])),onDrop:A(K,["prevent"]),onClick:e[2]||(e[2]=i=>n.$refs.fileInput.click())},[s("input",{ref:"fileInput",type:"file",accept:".apkg",class:"hidden",onChange:H},null,544),s("div",be,[s("div",{class:y(["p-4 rounded-full transition-transform group-hover:scale-110 duration-300",u.value?"bg-emerald-100 text-emerald-600 dark:bg-emerald-900/30":"bg-slate-100 text-slate-500 dark:bg-slate-800"])},[u.value?(o(),$(t(ce),{key:0,class:"w-8 h-8"})):(o(),$(t(me),{key:1,class:"w-8 h-8"}))],2),u.value?(o(),f("div",ye,[s("h3",_e,m(u.value.name),1),s("p",we,m((u.value.size/1024/1024).toFixed(2))+" MB",1),e[9]||(e[9]=s("div",{class:"mt-2 text-xs text-slate-400"},"Click to change file",-1))])):(o(),f("div",he,[...e[10]||(e[10]=[s("h3",{class:"font-semibold text-lg text-slate-900 dark:text-slate-100"},"Drag & Drop or Click to Upload",-1),s("p",{class:"text-sm text-slate-500 mt-1"},"Accepts .apkg files only",-1)])]))])],34),k.value?(o(),$(t(Y),{key:0,variant:"destructive"},{default:l(()=>[a(t(W),{class:"h-4 w-4"}),a(t(J),null,{default:l(()=>[...e[11]||(e[11]=[r("Error",-1)])]),_:1}),a(t(Q),null,{default:l(()=>[r(m(k.value),1)]),_:1})]),_:1})):P("",!0)]),_:1}),a(t(O),{class:"flex flex-col sm:flex-row gap-4 sm:gap-0 justify-between border-t bg-slate-50/50 dark:bg-slate-900/50 p-4 sm:p-6"},{default:l(()=>[e[13]||(e[13]=s("p",{class:"text-xs text-slate-400 w-full sm:max-w-[60%] text-center sm:text-left order-2 sm:order-1"},[r(" Need help exporting from Anki? Go to "),s("span",{class:"font-medium"},"File > Export..."),r(' and select "Anki Deck Package (*.apkg)". ')],-1)),a(t(D),{onClick:Z,disabled:!u.value,size:"lg",class:"w-full sm:w-auto shadow-sm order-1 sm:order-2"},{default:l(()=>[e[12]||(e[12]=r(" Start Import ",-1)),a(t(L),{class:"w-4 h-4 ml-2"})]),_:1},8,["disabled"])]),_:1})])):d.value===1?(o(),f("div",$e,[s("div",Ie,[a(t(se),{class:"w-16 h-16 text-primary animate-spin"}),s("div",Ce,m(p.value)+"%",1)]),e[15]||(e[15]=s("h2",{class:"text-2xl font-bold mb-2"},"Importing your data...",-1)),e[16]||(e[16]=s("p",{class:"text-slate-500 max-w-md mb-8"},"Please wait while we unzip your package, parse the database, and generate your cards. This may take a few moments for large decks.",-1)),s("div",Ae,[s("div",De,[e[14]||(e[14]=s("span",null,"Processing...",-1)),s("span",null,m(p.value)+"%",1)]),a(t(ne),{"model-value":p.value,class:"h-2"},null,8,["model-value"])])])):d.value===2?(o(),f("div",Se,[a(t(E),{class:"border-b bg-emerald-50/30 dark:bg-emerald-900/10"},{default:l(()=>[s("div",je,[s("div",Me,[a(t(U),{class:"w-6 h-6"})]),s("div",null,[a(t(N),{class:"text-emerald-700 dark:text-emerald-400"},{default:l(()=>[...e[17]||(e[17]=[r("Import Complete!",-1)])]),_:1}),a(t(G),null,{default:l(()=>[...e[18]||(e[18]=[r("Your Anki collection has been successfully migrated.",-1)])]),_:1})])])]),_:1}),a(t(R),{class:"p-0"},{default:l(()=>[a(t(ie),null,{default:l(()=>[a(t(ue),null,{default:l(()=>[a(t(I),null,{default:l(()=>[a(t(M),{class:"pl-6"},{default:l(()=>[...e[19]||(e[19]=[r("Resource",-1)])]),_:1}),a(t(M),{class:"text-right"},{default:l(()=>[...e[20]||(e[20]=[r("Count",-1)])]),_:1}),a(t(M),{class:"text-right pr-6"},{default:l(()=>[...e[21]||(e[21]=[r("Status",-1)])]),_:1})]),_:1})]),_:1}),a(t(fe),null,{default:l(()=>[a(t(I),null,{default:l(()=>[a(t(c),{class:"font-medium pl-6"},{default:l(()=>[...e[22]||(e[22]=[r("Decks",-1)])]),_:1}),a(t(c),{class:"text-right"},{default:l(()=>[r(m(_.value.decks),1)]),_:1}),a(t(c),{class:"text-right pr-6"},{default:l(()=>[a(t(S),{variant:"outline",class:"text-emerald-600 border-emerald-200 bg-emerald-50"},{default:l(()=>[...e[23]||(e[23]=[r("Created",-1)])]),_:1})]),_:1})]),_:1}),a(t(I),null,{default:l(()=>[a(t(c),{class:"font-medium pl-6"},{default:l(()=>[...e[24]||(e[24]=[r("Notes",-1)])]),_:1}),a(t(c),{class:"text-right"},{default:l(()=>[r(m(_.value.notes),1)]),_:1}),a(t(c),{class:"text-right pr-6"},{default:l(()=>[a(t(S),{variant:"outline",class:"text-emerald-600 border-emerald-200 bg-emerald-50"},{default:l(()=>[...e[25]||(e[25]=[r("Created",-1)])]),_:1})]),_:1})]),_:1}),a(t(I),null,{default:l(()=>[a(t(c),{class:"font-medium pl-6"},{default:l(()=>[...e[26]||(e[26]=[r("Cards",-1)])]),_:1}),a(t(c),{class:"text-right"},{default:l(()=>[r(m(_.value.cards),1)]),_:1}),a(t(c),{class:"text-right pr-6"},{default:l(()=>[a(t(S),{variant:"outline",class:"text-emerald-600 border-emerald-200 bg-emerald-50"},{default:l(()=>[...e[27]||(e[27]=[r("Generated",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(t(O),{class:"flex flex-col-reverse sm:flex-row justify-between items-center p-4 sm:p-6 bg-slate-50/50 dark:bg-slate-900/50 border-t gap-3 sm:gap-0"},{default:l(()=>[a(t(D),{variant:"outline",onClick:X,class:"w-full sm:w-auto"},{default:l(()=>[...e[28]||(e[28]=[r("Import Another",-1)])]),_:1}),a(t(D),{onClick:e[3]||(e[3]=i=>t(g).push("/decks")),class:"w-full sm:w-auto"},{default:l(()=>[e[29]||(e[29]=r("View Decks ",-1)),a(t(L),{class:"w-4 h-4 ml-2"})]),_:1})]),_:1})])):P("",!0)]),_:1})]))}};export{Be as default};
