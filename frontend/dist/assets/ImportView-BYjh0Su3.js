import{c as S,r as x,d as c,e as s,f as a,R as X,S as Z,P as y,g as _,u as t,C as F,t as m,w as l,n as P,m as U,U as z,h as r,q as T,aM as B,aN as N,aO as V,Y as $,j as I,aP as E,a2 as ee,l as C,i as te,s as ae,x as le,y as A,A as i}from"./index-BOzyvhxc.js";import{_ as R}from"./CardDescription-CBsqXgs6.js";import{_ as q}from"./CardFooter-DmoYhChA.js";import{_ as se}from"./Progress-CmssFzwS.js";import{_ as re,a as de,b as w,c as D,d as oe,e as f}from"./TableHeader-pdgw_vYv.js";const L=S("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const ie=S("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);const ne=S("file-type",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11 18h2",key:"12mj7e"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M9 13v-.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v.5",key:"qbrxap"}]]),ue={class:"p-4 sm:p-6 max-w-3xl mx-auto space-y-6 sm:space-y-8"},me={class:"grid grid-cols-3 gap-4"},fe={key:1},pe={class:"font-medium text-sm hidden sm:block"},ce={key:0,class:"animate-in fade-in slide-in-from-bottom-4 duration-500"},ve={class:"flex flex-col items-center gap-4 text-center"},xe={key:0},ge={class:"font-semibold text-lg text-emerald-700 dark:text-emerald-400"},ke={class:"text-sm text-slate-500"},be={key:1},ye={key:1,class:"py-12 px-6 flex flex-col items-center justify-center text-center animate-in fade-in zoom-in-95 duration-500"},_e={class:"relative mb-8"},we={class:"absolute inset-0 flex items-center justify-center font-bold text-xs"},he={class:"w-full max-w-md space-y-2"},$e={class:"flex justify-between text-xs text-slate-400"},Ie={key:2,class:"animate-in fade-in slide-in-from-right-4 duration-500"},Ce={class:"flex items-center gap-4"},Ae={class:"p-2 bg-emerald-100 text-emerald-600 rounded-full dark:bg-emerald-900/30"},Ue={__name:"ImportView",setup(De){const Y=te(),G="https://hands-dedicated-bold-olympic.trycloudflare.com/api/v1",u=x(0),O=[{id:0,title:"Upload",description:"Select your Anki package"},{id:1,title:"Importing",description:"Processing data"},{id:2,title:"Summary",description:"Review results"}],n=x(null),k=x(!1),h=x(!1),p=x(0),g=x(null),v=x(null),W=d=>{const e=d.target.files[0];j(e)},H=d=>{k.value=!1;const e=d.dataTransfer.files[0];j(e)},j=d=>{d&&d.name.endsWith(".apkg")?(n.value=d,v.value=null):A.error("Invalid file type",{description:"Please select a valid .apkg file"})},J=()=>{n.value=null,g.value=null,v.value=null,u.value=0,p.value=0},K=async()=>{if(!n.value)return;u.value=1,h.value=!0,v.value=null,p.value=10;const d=setInterval(()=>{p.value<90&&(p.value+=5)},200),e=new FormData;e.append("file",n.value);const o=localStorage.getItem("auth_token");try{const{data:b,response:Q,error:M}=await le(`${G}/import/anki`,{method:"POST",body:e,headers:{Authorization:`Bearer ${o}`}}).json();if(clearInterval(d),p.value=100,M.value||!Q.value.ok)throw new Error(b.value?.message||M.value||"Upload failed");setTimeout(()=>{g.value=b.value,u.value=2,h.value=!1,A.success("Import successful!")},500)}catch(b){clearInterval(d),h.value=!1,u.value=0,v.value=b.message||"An unexpected error occurred during import.",A.error("Import failed",{description:v.value})}};return(d,e)=>(i(),c("div",ue,[e[30]||(e[30]=s("div",{class:"flex items-center gap-4"},[s("div",null,[s("h1",{class:"text-2xl sm:text-3xl font-bold tracking-tight text-slate-900 dark:text-slate-50"},"Import from Anki"),s("p",{class:"text-slate-500 dark:text-slate-400"},"Migrate your decks and cards effortlessly.")])],-1)),s("div",me,[(i(),c(X,null,Z(O,o=>s("div",{key:o.id,class:"flex flex-col gap-2"},[s("div",{class:y(["flex items-center gap-2",u.value>=o.id?"text-primary":"text-slate-400"])},[s("div",{class:y(["flex h-8 w-8 items-center justify-center rounded-full border-2 text-sm font-semibold transition-colors",u.value>=o.id?"border-primary bg-primary text-primary-foreground":"border-slate-200 bg-transparent"])},[u.value>o.id?(i(),_(t(F),{key:0,class:"w-4 h-4"})):(i(),c("span",fe,m(o.id+1),1))],2),s("span",pe,m(o.title),1)],2),e[4]||(e[4]=s("div",{class:"h-1 w-full rounded-full bg-slate-100 dark:bg-slate-800 absolute bottom-0 left-0 hidden"},null,-1))])),64))]),a(t(ae),{class:"overflow-hidden shadow-lg border-slate-200 dark:border-slate-800 transition-all duration-300"},{default:l(()=>[u.value===0?(i(),c("div",ce,[a(t(U),{class:"mb-2"},{default:l(()=>[a(t(z),null,{default:l(()=>[...e[5]||(e[5]=[r("Select File",-1)])]),_:1}),a(t(R),null,{default:l(()=>[...e[6]||(e[6]=[r("Upload an .apkg file exported from Anki. This will import notes, cards, and media.",-1)])]),_:1})]),_:1}),a(t(T),{class:"space-y-6"},{default:l(()=>[a(t(B),{variant:"default",class:"bg-blue-50 border-blue-200 text-blue-800 dark:bg-blue-950/30 dark:border-blue-900 dark:text-blue-300"},{default:l(()=>[a(t(L),{class:"h-4 w-4"}),a(t(N),null,{default:l(()=>[...e[7]||(e[7]=[r("Important",-1)])]),_:1}),a(t(V),null,{default:l(()=>[...e[8]||(e[8]=[r(" Importing is a safe operation. It will create new decks and cards. Your existing Tsuyanki decks will not be overwritten unless they share exact IDs (which is rare). ",-1)])]),_:1})]),_:1}),s("div",{class:y(["relative border-2 border-dashed rounded-xl p-6 sm:p-12 transition-all cursor-pointer group",[k.value?"border-primary bg-primary/5 scale-[1.01]":"border-slate-200 hover:border-primary/50 hover:bg-slate-50 dark:border-slate-800 dark:hover:bg-slate-900",n.value?"bg-emerald-50/50 border-emerald-200 dark:bg-emerald-900/10 dark:border-emerald-800":""]]),onDragover:e[0]||(e[0]=$(o=>k.value=!0,["prevent"])),onDragleave:e[1]||(e[1]=$(o=>k.value=!1,["prevent"])),onDrop:$(H,["prevent"]),onClick:e[2]||(e[2]=o=>d.$refs.fileInput.click())},[s("input",{ref:"fileInput",type:"file",accept:".apkg",class:"hidden",onChange:W},null,544),s("div",ve,[s("div",{class:y(["p-4 rounded-full transition-transform group-hover:scale-110 duration-300",n.value?"bg-emerald-100 text-emerald-600 dark:bg-emerald-900/30":"bg-slate-100 text-slate-500 dark:bg-slate-800"])},[n.value?(i(),_(t(ne),{key:0,class:"w-8 h-8"})):(i(),_(t(ie),{key:1,class:"w-8 h-8"}))],2),n.value?(i(),c("div",xe,[s("h3",ge,m(n.value.name),1),s("p",ke,m((n.value.size/1024/1024).toFixed(2))+" MB",1),e[9]||(e[9]=s("div",{class:"mt-2 text-xs text-slate-400"},"Click to change file",-1))])):(i(),c("div",be,[...e[10]||(e[10]=[s("h3",{class:"font-semibold text-lg text-slate-900 dark:text-slate-100"},"Drag & Drop or Click to Upload",-1),s("p",{class:"text-sm text-slate-500 mt-1"},"Accepts .apkg files only",-1)])]))])],34),v.value?(i(),_(t(B),{key:0,variant:"destructive"},{default:l(()=>[a(t(L),{class:"h-4 w-4"}),a(t(N),null,{default:l(()=>[...e[11]||(e[11]=[r("Error",-1)])]),_:1}),a(t(V),null,{default:l(()=>[r(m(v.value),1)]),_:1})]),_:1})):P("",!0)]),_:1}),a(t(q),{class:"flex flex-col sm:flex-row gap-4 sm:gap-0 justify-between border-t bg-slate-50/50 dark:bg-slate-900/50 p-4 sm:p-6"},{default:l(()=>[e[13]||(e[13]=s("p",{class:"text-xs text-slate-400 w-full sm:max-w-[60%] text-center sm:text-left order-2 sm:order-1"},[r(" Need help exporting from Anki? Go to "),s("span",{class:"font-medium"},"File > Export..."),r(' and select "Anki Deck Package (*.apkg)". ')],-1)),a(t(I),{onClick:K,disabled:!n.value,size:"lg",class:"w-full sm:w-auto shadow-sm order-1 sm:order-2"},{default:l(()=>[e[12]||(e[12]=r(" Start Import ",-1)),a(t(E),{class:"w-4 h-4 ml-2"})]),_:1},8,["disabled"])]),_:1})])):u.value===1?(i(),c("div",ye,[s("div",_e,[a(t(ee),{class:"w-16 h-16 text-primary animate-spin"}),s("div",we,m(p.value)+"%",1)]),e[15]||(e[15]=s("h2",{class:"text-2xl font-bold mb-2"},"Importing your data...",-1)),e[16]||(e[16]=s("p",{class:"text-slate-500 max-w-md mb-8"},"Please wait while we unzip your package, parse the database, and generate your cards. This may take a few moments for large decks.",-1)),s("div",he,[s("div",$e,[e[14]||(e[14]=s("span",null,"Processing...",-1)),s("span",null,m(p.value)+"%",1)]),a(t(se),{"model-value":p.value,class:"h-2"},null,8,["model-value"])])])):u.value===2?(i(),c("div",Ie,[a(t(U),{class:"border-b bg-emerald-50/30 dark:bg-emerald-900/10"},{default:l(()=>[s("div",Ce,[s("div",Ae,[a(t(F),{class:"w-6 h-6"})]),s("div",null,[a(t(z),{class:"text-emerald-700 dark:text-emerald-400"},{default:l(()=>[...e[17]||(e[17]=[r("Import Complete!",-1)])]),_:1}),a(t(R),null,{default:l(()=>[...e[18]||(e[18]=[r("Your Anki collection has been successfully migrated.",-1)])]),_:1})])])]),_:1}),a(t(T),{class:"p-0"},{default:l(()=>[a(t(re),null,{default:l(()=>[a(t(de),null,{default:l(()=>[a(t(w),null,{default:l(()=>[a(t(D),{class:"pl-6"},{default:l(()=>[...e[19]||(e[19]=[r("Resource",-1)])]),_:1}),a(t(D),{class:"text-right"},{default:l(()=>[...e[20]||(e[20]=[r("Count",-1)])]),_:1}),a(t(D),{class:"text-right pr-6"},{default:l(()=>[...e[21]||(e[21]=[r("Status",-1)])]),_:1})]),_:1})]),_:1}),a(t(oe),null,{default:l(()=>[a(t(w),null,{default:l(()=>[a(t(f),{class:"font-medium pl-6"},{default:l(()=>[...e[22]||(e[22]=[r("Decks",-1)])]),_:1}),a(t(f),{class:"text-right"},{default:l(()=>[r(m(g.value.decks),1)]),_:1}),a(t(f),{class:"text-right pr-6"},{default:l(()=>[a(t(C),{variant:"outline",class:"text-emerald-600 border-emerald-200 bg-emerald-50"},{default:l(()=>[...e[23]||(e[23]=[r("Created",-1)])]),_:1})]),_:1})]),_:1}),a(t(w),null,{default:l(()=>[a(t(f),{class:"font-medium pl-6"},{default:l(()=>[...e[24]||(e[24]=[r("Notes",-1)])]),_:1}),a(t(f),{class:"text-right"},{default:l(()=>[r(m(g.value.notes),1)]),_:1}),a(t(f),{class:"text-right pr-6"},{default:l(()=>[a(t(C),{variant:"outline",class:"text-emerald-600 border-emerald-200 bg-emerald-50"},{default:l(()=>[...e[25]||(e[25]=[r("Created",-1)])]),_:1})]),_:1})]),_:1}),a(t(w),null,{default:l(()=>[a(t(f),{class:"font-medium pl-6"},{default:l(()=>[...e[26]||(e[26]=[r("Cards",-1)])]),_:1}),a(t(f),{class:"text-right"},{default:l(()=>[r(m(g.value.cards),1)]),_:1}),a(t(f),{class:"text-right pr-6"},{default:l(()=>[a(t(C),{variant:"outline",class:"text-emerald-600 border-emerald-200 bg-emerald-50"},{default:l(()=>[...e[27]||(e[27]=[r("Generated",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(t(q),{class:"flex flex-col-reverse sm:flex-row justify-between items-center p-4 sm:p-6 bg-slate-50/50 dark:bg-slate-900/50 border-t gap-3 sm:gap-0"},{default:l(()=>[a(t(I),{variant:"outline",onClick:J,class:"w-full sm:w-auto"},{default:l(()=>[...e[28]||(e[28]=[r("Import Another",-1)])]),_:1}),a(t(I),{onClick:e[3]||(e[3]=o=>t(Y).push("/decks")),class:"w-full sm:w-auto"},{default:l(()=>[e[29]||(e[29]=r("View Decks ",-1)),a(t(E),{class:"w-4 h-4 ml-2"})]),_:1})]),_:1})])):P("",!0)]),_:1})]))}};export{Ue as default};
