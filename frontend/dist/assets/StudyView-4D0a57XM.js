import{c as H,r as p,a as q,o as N,b as U,d as g,e as t,f as s,t as y,u as a,g as I,_ as V,C as F,w as r,h as f,i as O,j as b,k as G,l as Y,m as J,n as T,p as K,q as Q,s as W,v as E,x as P,y as x}from"./index-BEtY19qK.js";import{_ as X}from"./CardFooter-e1seiDy3.js";import{_ as Z}from"./Progress-BavTToHH.js";import{_ as z}from"./Separator-BStYv4os.js";const ee=H("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),te=($,C)=>{const m=$.__vccOpts||$;for(const[w,i]of C)m[w]=i;return m},ae={class:"min-h-full flex flex-col max-w-4xl mx-auto w-full p-4 lg:p-8"},se={class:"mb-8 space-y-2 shrink-0"},le={class:"flex items-center justify-between text-sm text-slate-500 dark:text-slate-400"},re={class:"flex-1 flex flex-col items-center w-full relative"},oe={key:0,class:"w-full max-w-2xl space-y-4 my-auto"},ne={class:"flex justify-center gap-4"},ie={key:1,class:"text-center space-y-6 my-auto"},de={class:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 mb-4"},ue={class:"text-slate-500 dark:text-slate-400 max-w-md mx-auto text-lg"},ve={class:"flex flex-col sm:flex-row justify-center gap-4 pt-4 px-4 sm:px-0 w-full"},ce={class:"flex items-center gap-2 bg-slate-50 dark:bg-slate-900 p-1 rounded-lg border border-slate-200 dark:border-slate-800 w-full sm:w-auto order-1 sm:order-2"},fe={class:"relative w-20 shrink-0"},xe={class:"flex justify-between items-center"},me={class:"prose dark:prose-invert max-w-none text-center w-full break-words"},pe=["innerHTML"],be={key:0,class:"w-full flex items-center gap-4 animate-in fade-in duration-300"},ge={key:1,class:"prose dark:prose-invert max-w-none w-full break-words animate-in slide-in-from-bottom-2 duration-300 text-left"},we=["innerHTML"],ke={key:1,class:"grid grid-cols-4 gap-3 w-full animate-in fade-in slide-in-from-bottom-2 duration-300"},_e={class:"flex flex-col gap-1 group"},he={class:"flex flex-col gap-1 group"},ye={class:"flex flex-col gap-1 group"},$e={class:"flex flex-col gap-1 group"},Ce={__name:"StudyView",setup($){const C=O(),m=W(),w="https://activities-associates-involving-soul.trycloudflare.com/api/v1",i=p([]),k=p(0),d=p(!1),_=p(!0),u=p(!1),S=p(20),l=p({total:0,reviewed:0,correct:0}),v=q(()=>!i.value||i.value.length===0?null:i.value[k.value]),D=q(()=>l.value.total===0?0:l.value.reviewed/l.value.total*100),A=async(o=!1,e=null)=>{_.value=!0;const n=localStorage.getItem("auth_token"),h=e||m.query.limit||20,L=new URLSearchParams({limit:h.toString()});(o===!0||m.query.deck_id)&&L.append("ignore_limits","1"),m.query.deck_id&&L.append("deck_id",m.query.deck_id);try{const{data:j}=await E(`${w}/review/due?${L.toString()}`,{headers:{Authorization:`Bearer ${n}`}}).json();if(j.value){const R=j.value.cards||[];i.value=R,o?l.value.total+=R.length:(l.value.total=R.length,l.value.reviewed=0,l.value.correct=0),k.value=0,d.value=!1}}catch{P.error("Failed to load cards",{description:"Please try again later."})}finally{_.value=!1}},B=()=>{d.value=!0},c=async o=>{if(!v.value||u.value)return;u.value=!0;const e=localStorage.getItem("auth_token"),n=v.value.id||v.value.card_id;try{const{error:h}=await E(`${w}/review/${n}`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({quality:o})}).json();if(h.value)throw new Error("Review failed");l.value.reviewed++,o>=3&&l.value.correct++,k.value<i.value.length-1?(k.value++,d.value=!1):i.value=[]}catch{P.error("Failed to save review",{description:"Your progress was not saved."})}finally{u.value=!1}},M=o=>{if(!(_.value||!v.value)&&(o.code==="Space"&&(o.preventDefault(),d.value||B()),d.value&&!u.value))switch(o.key){case"1":c(1);break;case"2":c(2);break;case"3":c(3);break;case"4":c(4);break}};return N(()=>{A(),window.addEventListener("keydown",M)}),U(()=>{window.removeEventListener("keydown",M)}),(o,e)=>(x(),g("div",ae,[t("div",se,[t("div",le,[e[7]||(e[7]=t("span",{class:"font-medium"},"Daily Review",-1)),t("span",null,y(l.value.reviewed)+" / "+y(l.value.total),1)]),s(a(Z),{"model-value":D.value,class:"h-2"},null,8,["model-value"])]),t("div",re,[_.value?(x(),g("div",oe,[s(a(V),{class:"h-[300px] w-full rounded-xl"}),t("div",ne,[s(a(V),{class:"h-12 w-24"}),s(a(V),{class:"h-12 w-24"})])])):v.value?(x(),I(a(Q),{key:2,class:"w-full max-w-2xl shadow-xl border-t-4 border-t-indigo-500 dark:bg-slate-900 my-auto mb-8"},{default:r(()=>[s(a(J),null,{default:r(()=>[t("div",xe,[s(a(Y),{variant:"outline",class:"uppercase tracking-wide text-[10px]"},{default:r(()=>[f(y(v.value.template?.name||"Standard"),1)]),_:1}),e[11]||(e[11]=t("span",{class:"text-xs text-slate-400"},"Press Space to reveal",-1))])]),_:1}),s(a(K),{class:"py-6 px-6 min-h-[200px] flex flex-col gap-6 max-h-[60vh] overflow-y-auto w-full"},{default:r(()=>[t("div",me,[t("div",{class:"text-xl font-medium",innerHTML:v.value.front_html},null,8,pe)]),d.value?(x(),g("div",be,[s(a(z),{class:"flex-1"}),e[12]||(e[12]=t("span",{class:"text-xs text-slate-400 uppercase"},"Answer",-1)),s(a(z),{class:"flex-1"})])):T("",!0),d.value?(x(),g("div",ge,[t("div",{class:"text-lg",innerHTML:v.value.back_html},null,8,we)])):T("",!0)]),_:1}),s(a(X),{class:"flex flex-col gap-4 border-t bg-slate-50/50 dark:bg-slate-950/30 p-6"},{default:r(()=>[d.value?(x(),g("div",ke,[t("div",_e,[s(a(b),{onClick:e[3]||(e[3]=n=>c(1)),variant:"outline",class:"h-14 hover:bg-rose-100 hover:text-rose-700 hover:border-rose-200 dark:hover:bg-rose-900/30 dark:hover:text-rose-400 border-b-4 active:border-b-0 active:translate-y-1",disabled:u.value},{default:r(()=>[...e[14]||(e[14]=[f(" Again ",-1)])]),_:1},8,["disabled"]),e[15]||(e[15]=t("span",{class:"text-[10px] text-center text-slate-400 group-hover:text-slate-600 uppercase font-bold tracking-wider"},"< 1m",-1))]),t("div",he,[s(a(b),{onClick:e[4]||(e[4]=n=>c(2)),variant:"outline",class:"h-14 hover:bg-orange-100 hover:text-orange-700 hover:border-orange-200 dark:hover:bg-orange-900/30 dark:hover:text-orange-400 border-b-4 active:border-b-0 active:translate-y-1",disabled:u.value},{default:r(()=>[...e[16]||(e[16]=[f(" Hard ",-1)])]),_:1},8,["disabled"]),e[17]||(e[17]=t("span",{class:"text-[10px] text-center text-slate-400 group-hover:text-slate-600 uppercase font-bold tracking-wider"},"2d",-1))]),t("div",ye,[s(a(b),{onClick:e[5]||(e[5]=n=>c(3)),variant:"outline",class:"h-14 hover:bg-blue-100 hover:text-blue-700 hover:border-blue-200 dark:hover:bg-blue-900/30 dark:hover:text-blue-400 border-b-4 active:border-b-0 active:translate-y-1",disabled:u.value},{default:r(()=>[...e[18]||(e[18]=[f(" Good ",-1)])]),_:1},8,["disabled"]),e[19]||(e[19]=t("span",{class:"text-[10px] text-center text-slate-400 group-hover:text-slate-600 uppercase font-bold tracking-wider"},"4d",-1))]),t("div",$e,[s(a(b),{onClick:e[6]||(e[6]=n=>c(4)),variant:"outline",class:"h-14 hover:bg-emerald-100 hover:text-emerald-700 hover:border-emerald-200 dark:hover:bg-emerald-900/30 dark:hover:text-emerald-400 border-b-4 active:border-b-0 active:translate-y-1",disabled:u.value},{default:r(()=>[...e[20]||(e[20]=[f(" Easy ",-1)])]),_:1},8,["disabled"]),e[21]||(e[21]=t("span",{class:"text-[10px] text-center text-slate-400 group-hover:text-slate-600 uppercase font-bold tracking-wider"},"7d",-1))])])):(x(),I(a(b),{key:0,onClick:B,class:"w-full h-12 text-lg font-semibold tracking-wide",size:"lg"},{default:r(()=>[...e[13]||(e[13]=[f(" Show Answer ",-1)])]),_:1}))]),_:1})]),_:1})):(x(),g("div",ie,[t("div",de,[s(a(F),{class:"w-10 h-10"})]),e[10]||(e[10]=t("h2",{class:"text-3xl font-bold tracking-tight text-slate-900 dark:text-slate-50"},"Session Complete!",-1)),t("p",ue," You reviewed "+y(l.value.reviewed)+" cards today. Great job keeping up with your streak! ",1),t("div",ve,[s(a(b),{onClick:e[0]||(e[0]=n=>a(C).push("/dashboard")),size:"lg",variant:"outline",class:"w-full sm:w-auto order-2 sm:order-1"},{default:r(()=>[...e[8]||(e[8]=[f(" Back to Dashboard ",-1)])]),_:1}),t("div",ce,[t("div",fe,[s(a(G),{type:"number",min:"1",max:"100",modelValue:S.value,"onUpdate:modelValue":e[1]||(e[1]=n=>S.value=n),class:"h-10 border-0 bg-transparent text-center focus-visible:ring-0 focus-visible:ring-offset-0"},null,8,["modelValue"])]),s(a(b),{onClick:e[2]||(e[2]=()=>A(!0,S.value)),size:"lg",class:"flex-1 sm:flex-initial"},{default:r(()=>[s(a(ee),{class:"w-4 h-4 mr-2"}),e[9]||(e[9]=f(" Review More ",-1))]),_:1})])])]))])]))}},Ve=te(Ce,[["__scopeId","data-v-102dc6f1"]]);export{Ve as default};
